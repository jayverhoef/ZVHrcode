
# SAS code for average variance of GLS estimates of treatment differences for the 9-observation example of Section 10.6:
proc iml;
x={1 0 0 1 0 0,
1 0 0 0 1 0,
1 0 0 0 0 1,
0 1 0 1 0 0,
0 1 0 0 1 0,
0 1 0 0 0 1,
0 0 1 1 0 0,
0 0 1 0 1 0,
0 0 1 0 0 1};
id=i(3);
cov={1 0.8 0.64,
0.8 1 0.8,
0.64 0.8 1};
v=id@cov;
con1={0,0,0,1,-1,0};
con2={0,0,0,1,0,-1};
con3={0,0,0,0,1,-1};
ginvvar=ginv(x`*inv(v)*x);
var1=con1`*ginvvar*con1;
var2=con2`*ginvvar*con2;
var3=con3`*ginvvar*con3;
var=var1+var2+var3;
print x var;
run;

proc iml;
x={1 0 0 1 0 0,
1 0 0 0 1 0,
1 0 0 0 0 1,
0 1 0 1 0 0,
0 1 0 0 1 0,
0 1 0 0 0 1,
0 0 1 1 0 0,
0 0 1 0 0 1,
0 0 1 0 1 0};
id=i(3);
cov={1 0.8 0.64,
0.8 1 0.8,
0.64 0.8 1};
v=id@cov;
con1={0,0,0,1,-1,0};
con2={0,0,0,1,0,-1};
con3={0,0,0,0,1,-1};
ginvvar=ginv(x`*inv(v)*x);
var1=con1`*ginvvar*con1;
var2=con2`*ginvvar*con2;
var3=con3`*ginvvar*con3;
var=var1+var2+var3;
print x var;
run;

proc iml;
x={1 0 0 1 0 0,
1 0 0 0 1 0,
1 0 0 0 0 1,
0 1 0 1 0 0,
0 1 0 0 1 0,
0 1 0 0 0 1,
0 0 1 0 1 0,
0 0 1 0 0 1,
0 0 1 1 0 0};
id=i(3);
cov={1 0.8 0.64,
0.8 1 0.8,
0.64 0.8 1};
v=id@cov;
con1={0,0,0,1,-1,0};
con2={0,0,0,1,0,-1};
con3={0,0,0,0,1,-1};
ginvvar=ginv(x`*inv(v)*x);
var1=con1`*ginvvar*con1;
var2=con2`*ginvvar*con2;
var3=con3`*ginvvar*con3;
var=var1+var2+var3;
print x var;
run;

proc iml;
x={1 0 0 1 0 0,
1 0 0 0 1 0,
1 0 0 0 0 1,
0 1 0 1 0 0,
0 1 0 0 1 0,
0 1 0 0 0 1,
0 0 1 0 1 0,
0 0 1 1 0 0,
0 0 1 0 0 1};
id=i(3);
cov={1 0.8 0.64,
0.8 1 0.8,
0.64 0.8 1};
v=id@cov;
con1={0,0,0,1,-1,0};
con2={0,0,0,1,0,-1};
con3={0,0,0,0,1,-1};
ginvvar=ginv(x`*inv(v)*x);
var1=con1`*ginvvar*con1;
var2=con2`*ginvvar*con2;
var3=con3`*ginvvar*con3;
var=var1+var2+var3;
print x var;
run;

proc iml;
x={1 0 0 1 0 0,
1 0 0 0 1 0,
1 0 0 0 0 1,
0 1 0 1 0 0,
0 1 0 0 1 0,
0 1 0 0 0 1,
0 0 1 0 0 1,
0 0 1 1 0 0,
0 0 1 0 1 0};
id=i(3);
cov={1 0.8 0.64,
0.8 1 0.8,
0.64 0.8 1};
v=id@cov;
con1={0,0,0,1,-1,0};
con2={0,0,0,1,0,-1};
con3={0,0,0,0,1,-1};
ginvvar=ginv(x`*inv(v)*x);
var1=con1`*ginvvar*con1;
var2=con2`*ginvvar*con2;
var3=con3`*ginvvar*con3;
var=var1+var2+var3;
print x var;
run;

proc iml;
x={1 0 0 1 0 0,
1 0 0 0 1 0,
1 0 0 0 0 1,
0 1 0 1 0 0,
0 1 0 0 1 0,
0 1 0 0 0 1,
0 0 1 0 0 1,
0 0 1 0 1 0,
0 0 1 1 0 0};
id=i(3);
cov={1 0.8 0.64,
0.8 1 0.8,
0.64 0.8 1};
v=id@cov;
con1={0,0,0,1,-1,0};
con2={0,0,0,1,0,-1};
con3={0,0,0,0,1,-1};
ginvvar=ginv(x`*inv(v)*x);
var1=con1`*ginvvar*con1;
var2=con2`*ginvvar*con2;
var3=con3`*ginvvar*con3;
var=var1+var2+var3;
print x var;
run;

#
proc iml;
x={1 0 0 1 0 0,
1 0 0 0 1 0,
1 0 0 0 0 1,
0 1 0 1 0 0,
0 1 0 0 0 1,
0 1 0 0 1 0,
0 0 1 1 0 0,
0 0 1 0 0 1,
0 0 1 0 1 0};
id=i(3);
cov={1 0.8 0.64,
0.8 1 0.8,
0.64 0.8 1};
v=id@cov;
con1={0,0,0,1,-1,0};
con2={0,0,0,1,0,-1};
con3={0,0,0,0,1,-1};
ginvvar=ginv(x`*inv(v)*x);
var1=con1`*ginvvar*con1;
var2=con2`*ginvvar*con2;
var3=con3`*ginvvar*con3;
var=var1+var2+var3;
print x var;
run;

proc iml;
x={1 0 0 1 0 0,
1 0 0 0 1 0,
1 0 0 0 0 1,
0 1 0 1 0 0,
0 1 0 0 0 1,
0 1 0 0 1 0,
0 0 1 0 1 0,
0 0 1 0 0 1,
0 0 1 1 0 0};
id=i(3);
cov={1 0.8 0.64,
0.8 1 0.8,
0.64 0.8 1};
v=id@cov;
con1={0,0,0,1,-1,0};
con2={0,0,0,1,0,-1};
con3={0,0,0,0,1,-1};
ginvvar=ginv(x`*inv(v)*x);
var1=con1`*ginvvar*con1;
var2=con2`*ginvvar*con2;
var3=con3`*ginvvar*con3;
var=var1+var2+var3;
print x var;
run;

proc iml;
x={1 0 0 1 0 0,
1 0 0 0 1 0,
1 0 0 0 0 1,
0 1 0 1 0 0,
0 1 0 0 0 1,
0 1 0 0 1 0,
0 0 1 0 1 0,
0 0 1 1 0 0,
0 0 1 0 0 1};
id=i(3);
cov={1 0.8 0.64,
0.8 1 0.8,
0.64 0.8 1};
v=id@cov;
con1={0,0,0,1,-1,0};
con2={0,0,0,1,0,-1};
con3={0,0,0,0,1,-1};
ginvvar=ginv(x`*inv(v)*x);
var1=con1`*ginvvar*con1;
var2=con2`*ginvvar*con2;
var3=con3`*ginvvar*con3;
var=var1+var2+var3;
print x var;
run;

proc iml;
x={1 0 0 1 0 0,
1 0 0 0 1 0,
1 0 0 0 0 1,
0 1 0 1 0 0,
0 1 0 0 0 1,
0 1 0 0 1 0,
0 0 1 0 0 1,
0 0 1 1 0 0,
0 0 1 0 1 0};
id=i(3);
cov={1 0.8 0.64,
0.8 1 0.8,
0.64 0.8 1};
v=id@cov;
con1={0,0,0,1,-1,0};
con2={0,0,0,1,0,-1};
con3={0,0,0,0,1,-1};
ginvvar=ginv(x`*inv(v)*x);
var1=con1`*ginvvar*con1;
var2=con2`*ginvvar*con2;
var3=con3`*ginvvar*con3;
var=var1+var2+var3;
print x var;
run;

proc iml;
x={1 0 0 1 0 0,
1 0 0 0 1 0,
1 0 0 0 0 1,
0 1 0 1 0 0,
0 1 0 0 0 1,
0 1 0 0 1 0,
0 0 1 0 0 1,
0 0 1 0 1 0,
0 0 1 1 0 0};
id=i(3);
cov={1 0.8 0.64,
0.8 1 0.8,
0.64 0.8 1};
v=id@cov;
con1={0,0,0,1,-1,0};
con2={0,0,0,1,0,-1};
con3={0,0,0,0,1,-1};
ginvvar=ginv(x`*inv(v)*x);
var1=con1`*ginvvar*con1;
var2=con2`*ginvvar*con2;
var3=con3`*ginvvar*con3;
var=var1+var2+var3;
print x var;
run;

proc iml;
x={1 0 0 1 0 0,
1 0 0 0 1 0,
1 0 0 0 0 1,
0 1 0 0 1 0,
0 1 0 0 0 1,
0 1 0 1 0 0,
0 0 1 0 1 0,
0 0 1 0 0 1,
0 0 1 1 0 0};
id=i(3);
cov={1 0.8 0.64,
0.8 1 0.8,
0.64 0.8 1};
v=id@cov;
con1={0,0,0,1,-1,0};
con2={0,0,0,1,0,-1};
con3={0,0,0,0,1,-1};
ginvvar=ginv(x`*inv(v)*x);
var1=con1`*ginvvar*con1;
var2=con2`*ginvvar*con2;
var3=con3`*ginvvar*con3;
var=var1+var2+var3;
print x var;
run;

proc iml;
x={1 0 0 1 0 0,
1 0 0 0 1 0,
1 0 0 0 0 1,
0 1 0 0 1 0,
0 1 0 0 0 1,
0 1 0 1 0 0,
0 0 1 0 1 0,
0 0 1 1 0 0,
0 0 1 0 0 1};
id=i(3);
cov={1 0.8 0.64,
0.8 1 0.8,
0.64 0.8 1};
v=id@cov;
con1={0,0,0,1,-1,0};
con2={0,0,0,1,0,-1};
con3={0,0,0,0,1,-1};
ginvvar=ginv(x`*inv(v)*x);
var1=con1`*ginvvar*con1;
var2=con2`*ginvvar*con2;
var3=con3`*ginvvar*con3;
var=var1+var2+var3;
print x var;
run;

proc iml;
x={1 0 0 1 0 0,
1 0 0 0 1 0,
1 0 0 0 0 1,
0 1 0 0 1 0,
0 1 0 0 0 1,
0 1 0 1 0 0,
0 0 1 0 0 1,
0 0 1 1 0 0,
0 0 1 0 1 0};
id=i(3);
cov={1 0.8 0.64,
0.8 1 0.8,
0.64 0.8 1};
v=id@cov;
con1={0,0,0,1,-1,0};
con2={0,0,0,1,0,-1};
con3={0,0,0,0,1,-1};
ginvvar=ginv(x`*inv(v)*x);
var1=con1`*ginvvar*con1;
var2=con2`*ginvvar*con2;
var3=con3`*ginvvar*con3;
var=var1+var2+var3;
print x var;
run;

proc iml;
x={1 0 0 1 0 0,
1 0 0 0 1 0,
1 0 0 0 0 1,
0 1 0 0 1 0,
0 1 0 0 0 1,
0 1 0 1 0 0,
0 0 1 0 0 1,
0 0 1 0 1 0,
0 0 1 1 0 0};
id=i(3);
cov={1 0.8 0.64,
0.8 1 0.8,
0.64 0.8 1};
v=id@cov;
con1={0,0,0,1,-1,0};
con2={0,0,0,1,0,-1};
con3={0,0,0,0,1,-1};
ginvvar=ginv(x`*inv(v)*x);
var1=con1`*ginvvar*con1;
var2=con2`*ginvvar*con2;
var3=con3`*ginvvar*con3;
var=var1+var2+var3;
print x var;
run;

proc iml;
x={1 0 0 1 0 0,
1 0 0 0 1 0,
1 0 0 0 0 1,
0 1 0 0 1 0,
0 1 0 1 0 0,
0 1 0 0 0 1,
0 0 1 0 1 0,
0 0 1 1 0 0,
0 0 1 0 0 1};
id=i(3);
cov={1 0.8 0.64,
0.8 1 0.8,
0.64 0.8 1};
v=id@cov;
con1={0,0,0,1,-1,0};
con2={0,0,0,1,0,-1};
con3={0,0,0,0,1,-1};
ginvvar=ginv(x`*inv(v)*x);
var1=con1`*ginvvar*con1;
var2=con2`*ginvvar*con2;
var3=con3`*ginvvar*con3;
var=var1+var2+var3;
print x var;
run;

proc iml;
x={1 0 0 1 0 0,
1 0 0 0 1 0,
1 0 0 0 0 1,
0 1 0 0 1 0,
0 1 0 1 0 0,
0 1 0 0 0 1,
0 0 1 0 0 1,
0 0 1 1 0 0,
0 0 1 0 1 0};
id=i(3);
cov={1 0.8 0.64,
0.8 1 0.8,
0.64 0.8 1};
v=id@cov;
con1={0,0,0,1,-1,0};
con2={0,0,0,1,0,-1};
con3={0,0,0,0,1,-1};
ginvvar=ginv(x`*inv(v)*x);
var1=con1`*ginvvar*con1;
var2=con2`*ginvvar*con2;
var3=con3`*ginvvar*con3;
var=var1+var2+var3;
print x var;
run;

proc iml;
x={1 0 0 1 0 0,
1 0 0 0 1 0,
1 0 0 0 0 1,
0 1 0 0 1 0,
0 1 0 1 0 0,
0 1 0 0 0 1,
0 0 1 0 0 1,
0 0 1 0 1 0,
0 0 1 1 0 0};
id=i(3);
cov={1 0.8 0.64,
0.8 1 0.8,
0.64 0.8 1};
v=id@cov;
con1={0,0,0,1,-1,0};
con2={0,0,0,1,0,-1};
con3={0,0,0,0,1,-1};
ginvvar=ginv(x`*inv(v)*x);
var1=con1`*ginvvar*con1;
var2=con2`*ginvvar*con2;
var3=con3`*ginvvar*con3;
var=var1+var2+var3;
print x var;
run;

proc iml;
x={1 0 0 1 0 0,
1 0 0 0 1 0,
1 0 0 0 0 1,
0 1 0 0 0 1,
0 1 0 1 0 0,
0 1 0 0 1 0,
0 0 1 0 0 1,
0 0 1 1 0 0,
0 0 1 0 1 0};
id=i(3);
cov={1 0.8 0.64,
0.8 1 0.8,
0.64 0.8 1};
v=id@cov;
con1={0,0,0,1,-1,0};
con2={0,0,0,1,0,-1};
con3={0,0,0,0,1,-1};
ginvvar=ginv(x`*inv(v)*x);
var1=con1`*ginvvar*con1;
var2=con2`*ginvvar*con2;
var3=con3`*ginvvar*con3;
var=var1+var2+var3;
print x var;
run;

proc iml;
x={1 0 0 1 0 0,
1 0 0 0 1 0,
1 0 0 0 0 1,
0 1 0 0 0 1,
0 1 0 1 0 0,
0 1 0 0 1 0,
0 0 1 0 0 1,
0 0 1 0 1 0,
0 0 1 1 0 0};
id=i(3);
cov={1 0.8 0.64,
0.8 1 0.8,
0.64 0.8 1};
v=id@cov;
con1={0,0,0,1,-1,0};
con2={0,0,0,1,0,-1};
con3={0,0,0,0,1,-1};
ginvvar=ginv(x`*inv(v)*x);
var1=con1`*ginvvar*con1;
var2=con2`*ginvvar*con2;
var3=con3`*ginvvar*con3;
var=var1+var2+var3;
print x var;
run;

proc iml;
x={1 0 0 1 0 0,
1 0 0 0 1 0,
1 0 0 0 0 1,
0 1 0 0 0 1,
0 1 0 0 1 0,
0 1 0 1 0 0,
0 0 1 0 0 1,
0 0 1 0 1 0,
0 0 1 1 0 0};
id=i(3);
cov={1 0.8 0.64,
0.8 1 0.8,
0.64 0.8 1};
v=id@cov;
con1={0,0,0,1,-1,0};
con2={0,0,0,1,0,-1};
con3={0,0,0,0,1,-1};
ginvvar=ginv(x`*inv(v)*x);
var1=con1`*ginvvar*con1;
var2=con2`*ginvvar*con2;
var3=con3`*ginvvar*con3;
var=var1+var2+var3;
print x var;
run;

# SAS code to compute average variance of estimated treatment difference for a 5x5 quasi-complete Latin square design
# under a first-order CAR model:
proc iml;
x={1 0 0 0 0,
0 1 0 0 0,
0 0 1 0 0,
0 0 0 1 0,
0 0 0 0 1,
0 1 0 0 0,
0 0 0 1 0,
1 0 0 0 0,
0 0 0 0 1,
0 0 1 0 0,
0 0 1 0 0,
1 0 0 0 0,
0 0 0 0 1,
0 1 0 0 0,
0 0 0 1 0,
0 0 0 1 0,
0 0 0 0 1,
0 1 0 0 0,
0 0 1 0 0,
1 0 0 0 0,
0 0 0 0 1,
0 0 1 0 0,
0 0 0 1 0,
1 0 0 0 0,
0 1 0 0 0};
id=i(25);
nrook=j(25,25,0);
nrook[1,2]=1;
nrook[1,6]=1;
nrook[2,1]=1;
nrook[2,3]=1;
nrook[2,7]=1;
nrook[3,2]=1;
nrook[3,4]=1;
nrook[3,8]=1;
nrook[4,3]=1;
nrook[4,5]=1;
nrook[4,9]=1;
nrook[5,4]=1;
nrook[5,10]=1;
nrook[6,1]=1;
nrook[6,7]=1;
nrook[6,11]=1;
nrook[7,2]=1;
nrook[7,6]=1;
nrook[7,8]=1;
nrook[7,12]=1;
nrook[8,3]=1;
nrook[8,7]=1;
nrook[8,9]=1;
nrook[8,13]=1;
nrook[9,4]=1;
nrook[9,8]=1;
nrook[9,10]=1;
nrook[9,14]=1;
nrook[10,5]=1;
nrook[10,9]=1;
nrook[10,15]=1;
nrook[11,6]=1;
nrook[11,12]=1;
nrook[11,16]=1;
nrook[12,7]=1;
nrook[12,11]=1;
nrook[12,13]=1;
nrook[12,17]=1;
nrook[13,8]=1;
nrook[13,12]=1;
nrook[13,14]=1;
nrook[13,18]=1;
nrook[14,9]=1;
nrook[14,13]=1;
nrook[14,15]=1;
nrook[14,19]=1;
nrook[15,10]=1;
nrook[15,14]=1;
nrook[15,20]=1;
nrook[16,11]=1;
nrook[16,17]=1;
nrook[16,21]=1;
nrook[17,12]=1;
nrook[17,16]=1;
nrook[17,18]=1;
nrook[17,22]=1;
nrook[18,13]=1;
nrook[18,17]=1;
nrook[18,19]=1;
nrook[18,23]=1;
nrook[19,14]=1;
nrook[19,18]=1;
nrook[19,20]=1;
nrook[19,24]=1;
nrook[20,15]=1;
nrook[20,19]=1;
nrook[20,25]=1;
nrook[21,16]=1;
nrook[21,22]=1;
nrook[22,17]=1;
nrook[22,21]=1;
nrook[22,23]=1;
nrook[23,18]=1;
nrook[23,22]=1;
nrook[23,24]=1;
nrook[24,19]=1;
nrook[24,23]=1;
nrook[24,25]=1;
nrook[25,20]=1;
nrook[25,24]=1;
print nrook;
vinv=id-0.25#nrook;
ginvvar=ginv(x`*vinv*x);
con12={1,-1,0,0,0};
con13={1,0,-1,0,0};
con14={1,0,0,-1,0};
con15={1,0,0,0,-1};
con23={0,1,-1,0,0};
con24={0,1,0,-1,0};
con25={0,1,0,0,-1};
con34={0,0,1,-1,0};
con35={0,0,1,0,-1};
con45={0,0,0,1,-1};
var12=con12`*ginvvar*con12;
var13=con13`*ginvvar*con13;
var14=con14`*ginvvar*con14;
var15=con15`*ginvvar*con15;
var23=con23`*ginvvar*con23;
var24=con24`*ginvvar*con24;
var25=con25`*ginvvar*con25;
var34=con34`*ginvvar*con34;
var35=con35`*ginvvar*con35;
var45=con45`*ginvvar*con45;
var=var12+var13+var14+var15+var23+var24+var25+var34+var35+var45;
print x var;
run;

# SAS code to compute loss in efficiency using CRD rather than quasi-complete Latin square for a 5x5 arrangement of
# plots under a 1st-order CAR model
proc iml;
/** Module to permute the rows of a matrix **/
start PermuteRows(M);
   n = nrow(M);          /** how many rows? **/
   r = RanPerm(n);      /** or use RANPERM in SAS 9.3 to get a random permutation **/
   return ( M[r,] );     /** return matrix with permuted rows **/
finish;
x={1 0 0 0 0,
0 1 0 0 0,
0 0 1 0 0,
0 0 0 1 0,
0 0 0 0 1,
0 1 0 0 0,
0 0 0 1 0,
1 0 0 0 0,
0 0 0 0 1,
0 0 1 0 0,
0 0 1 0 0,
1 0 0 0 0,
0 0 0 0 1,
0 1 0 0 0,
0 0 0 1 0,
0 0 0 1 0,
0 0 0 0 1,
0 1 0 0 0,
0 0 1 0 0,
1 0 0 0 0,
0 0 0 0 1,
0 0 1 0 0,
0 0 0 1 0,
1 0 0 0 0,
0 1 0 0 0};
id=i(25);
nrook=j(25,25,0);
nrook[1,2]=1;
nrook[1,6]=1;
nrook[2,1]=1;
nrook[2,3]=1;
nrook[2,7]=1;
nrook[3,2]=1;
nrook[3,4]=1;
nrook[3,8]=1;
nrook[4,3]=1;
nrook[4,5]=1;
nrook[4,9]=1;
nrook[5,4]=1;
nrook[5,10]=1;
nrook[6,1]=1;
nrook[6,7]=1;
nrook[6,11]=1;
nrook[7,2]=1;
nrook[7,6]=1;
nrook[7,8]=1;
nrook[7,12]=1;
nrook[8,3]=1;
nrook[8,7]=1;
nrook[8,9]=1;
nrook[8,13]=1;
nrook[9,4]=1;
nrook[9,8]=1;
nrook[9,10]=1;
nrook[9,14]=1;
nrook[10,5]=1;
nrook[10,9]=1;
nrook[10,15]=1;
nrook[11,6]=1;
nrook[11,12]=1;
nrook[11,16]=1;
nrook[12,7]=1;
nrook[12,11]=1;
nrook[12,13]=1;
nrook[12,17]=1;
nrook[13,8]=1;
nrook[13,12]=1;
nrook[13,14]=1;
nrook[13,18]=1;
nrook[14,9]=1;
nrook[14,13]=1;
nrook[14,15]=1;
nrook[14,19]=1;
nrook[15,10]=1;
nrook[15,14]=1;
nrook[15,20]=1;
nrook[16,11]=1;
nrook[16,17]=1;
nrook[16,21]=1;
nrook[17,12]=1;
nrook[17,16]=1;
nrook[17,18]=1;
nrook[17,22]=1;
nrook[18,13]=1;
nrook[18,17]=1;
nrook[18,19]=1;
nrook[18,23]=1;
nrook[19,14]=1;
nrook[19,18]=1;
nrook[19,20]=1;
nrook[19,24]=1;
nrook[20,15]=1;
nrook[20,19]=1;
nrook[20,25]=1;
nrook[21,16]=1;
nrook[21,22]=1;
nrook[22,17]=1;
nrook[22,21]=1;
nrook[22,23]=1;
nrook[23,18]=1;
nrook[23,22]=1;
nrook[23,24]=1;
nrook[24,19]=1;
nrook[24,23]=1;
nrook[24,25]=1;
nrook[25,20]=1;
nrook[25,24]=1;
vinv=id-0.25#nrook;
do m=1 to 10;
x=PermuteRows(x);
ginvvar=ginv(x`*vinv*x);
con12={1,-1,0,0,0};
con13={1,0,-1,0,0};
con14={1,0,0,-1,0};
con15={1,0,0,0,-1};
con23={0,1,-1,0,0};
con24={0,1,0,-1,0};
con25={0,1,0,0,-1};
con34={0,0,1,-1,0};
con35={0,0,1,0,-1};
con45={0,0,0,1,-1};
var12=con12`*ginvvar*con12;
var13=con13`*ginvvar*con13;
var14=con14`*ginvvar*con14;
var15=con15`*ginvvar*con15;
var23=con23`*ginvvar*con23;
var24=con24`*ginvvar*con24;
var25=con25`*ginvvar*con25;
var34=con34`*ginvvar*con34;
var35=con35`*ginvvar*con35;
var45=con45`*ginvvar*con45;
var=var12+var13+var14+var15+var23+var24+var25+var34+var35+var45;
print x var;
end;
run;

